---
interface Props {
  title?: string;
}

const { title = "WingChun's Website" }: Props = Astro.props;
const currentPath = Astro.url.pathname;

const navLinks = [
  { href: "/", label: "Home" },
  { href: "/hw-list", label: "Hw List" },
  { href: "/math-game", label: "Math Game" },
  { href: "/blog", label: "Blog" },
];

function isActive(href: string): boolean {
  if (href === "/") return currentPath === "/";
  return currentPath.startsWith(href);
}
---

<!doctype html>
<html lang="zh-CN" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <title>{title}</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/gh/devicons/devicon@2.17.0/devicon.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles/markdown.css" />
  </head>
  <body>
    <!-- Initialize Fluent UI Web Components -->
    <script>
      import "../lib/fluent-init";
    </script>

    <div class="app-container">
      <header class="site-header">
        <h1 class="site-title">{title}</h1>
        <nav class="site-nav">
          {
            navLinks.map((link) => (
              <a
                href={link.href}
                class:list={["nav-link", { active: isActive(link.href) }]}
              >
                {link.label}
              </a>
            ))
          }
          <a
            href="https://github.com/WingChunWong"
            class="nav-link nav-github"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="bi bi-github" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span>
          </a>
        </nav>
      </header>

      <main>
        <div class="page-card">
          <div class="page-content">
            <slot />
          </div>
        </div>
      </main>
    </div>

    <style is:global>
      /* ══════════════════════════════════════════════════════════
         Global Reset & Base — Minimal CSS for Astro + Fluent WC
         ══════════════════════════════════════════════════════════ */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      :root {
        --colorNeutralBackground1: #1b1b1b;
        --colorNeutralBackground2: #202020;
        --colorNeutralBackground3: #282828;
        --colorNeutralBackground4: #333333;
        --colorNeutralForeground1: #ffffff;
        --colorNeutralForeground2: #d6d6d6;
        --colorNeutralForeground3: #adadad;
        --colorNeutralForeground4: #8a8a8a;
        --colorNeutralStroke1: #404040;
        --colorNeutralStroke2: #333333;
        --colorBrandBackground: #0f6cbd;
        --colorBrandForeground1: #479ef5;
        --colorBrandForeground2: #62abf5;
        --colorBrandStroke1: #479ef5;
        --colorBrandStroke2: rgba(71, 158, 245, 0.32);
        --colorSubtleBackgroundHover: rgba(255, 255, 255, 0.06);
        --colorSubtleBackgroundPressed: rgba(255, 255, 255, 0.04);
        --colorStatusSuccess: #0e700e;
        --colorStatusSuccessForeground: #54b054;
        --colorStatusSuccessBackground: rgba(14, 112, 14, 0.15);
        --colorStatusWarning: #f8d22a;
        --colorStatusWarningForeground: #f8d22a;
        --colorStatusError: #b10e1c;
        --colorStatusErrorForeground: #dc626d;
        --colorStatusErrorBackground: rgba(177, 14, 28, 0.15);
        --colorPaletteRedBackground1: rgba(196, 49, 75, 0.1);
        --colorPaletteRedForeground1: #dc626d;
        --colorPaletteGreenForeground1: #54b054;
        --borderRadiusSmall: 4px;
        --borderRadiusMedium: 6px;
        --borderRadiusLarge: 8px;
        --borderRadiusXLarge: 12px;
        --shadow2: 0 0 2px rgba(0, 0, 0, 0.24), 0 1px 2px rgba(0, 0, 0, 0.28);
        --shadow4: 0 0 2px rgba(0, 0, 0, 0.24), 0 2px 4px rgba(0, 0, 0, 0.28);
        --shadow8: 0 0 2px rgba(0, 0, 0, 0.24), 0 4px 8px rgba(0, 0, 0, 0.28);
        --shadow16: 0 0 2px rgba(0, 0, 0, 0.24),
          0 8px 16px rgba(0, 0, 0, 0.28);
        --shadow64: 0 0 2px rgba(0, 0, 0, 0.24),
          0 32px 64px rgba(0, 0, 0, 0.28);
        --fontFamilyBase: "Segoe UI Variable Display", "Segoe UI", system-ui,
          -apple-system, sans-serif;
        --fontFamilyMono: "Cascadia Code", "Fira Code", Consolas, monospace;
        --durationFast: 100ms;
        --durationNormal: 200ms;
        --durationSlow: 300ms;
        --curveEasyEase: cubic-bezier(0.33, 0, 0.67, 1);
        --curveDecelerateMid: cubic-bezier(0, 0, 0, 1);
      }

      body {
        margin: 0;
        background-color: var(--colorNeutralBackground1);
        color: var(--colorNeutralForeground1);
        font-family: var(--fontFamilyBase);
        font-size: 14px;
        line-height: 20px;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      ::selection {
        background: var(--colorBrandBackground);
        color: var(--colorNeutralForeground1);
      }

      /* Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: var(--colorNeutralStroke2);
        border-radius: 50%;
        border: 2px solid transparent;
        background-clip: content-box;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #737373;
        border: 2px solid transparent;
        background-clip: content-box;
      }

      /* Animations */
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      @keyframes fadeInScale {
        from {
          opacity: 0;
          transform: scale(0.97);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(12px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-12px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translateX(-16px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      @keyframes shimmer {
        0% {
          background-position: -200% 0;
        }
        100% {
          background-position: 200% 0;
        }
      }
      @keyframes spin {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      /* ── App Shell ── */
      .app-container {
        max-width: 1100px;
        margin: 0 auto;
        padding: 24px;
        animation: fadeIn var(--durationSlow) var(--curveDecelerateMid) both;
      }

      /* ── Site Header ── */
      .site-header {
        background: var(--colorNeutralBackground2);
        border: 1px solid var(--colorNeutralStroke2);
        border-radius: var(--borderRadiusLarge);
        padding: 16px 20px;
        margin-bottom: 20px;
        box-shadow: var(--shadow2);
        display: flex;
        align-items: center;
        gap: 20px;
        animation: slideDown var(--durationSlow) var(--curveDecelerateMid) both;
      }
      .site-title {
        margin: 0;
        margin-right: 20px;
        font-size: 20px;
        font-weight: 700;
        letter-spacing: -0.01em;
        white-space: nowrap;
      }
      .site-nav {
        display: flex;
        gap: 4px;
        align-items: center;
        flex: 1;
        min-width: 0;
      }

      /* ── Nav Links ── */
      .nav-link {
        position: relative;
        display: inline-flex;
        align-items: center;
        padding: 8px 12px;
        border-radius: var(--borderRadiusMedium);
        color: var(--colorNeutralForeground2);
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        transition:
          color var(--durationFast) var(--curveEasyEase),
          background var(--durationFast) var(--curveEasyEase);
      }
      .nav-link:hover {
        color: var(--colorBrandForeground1);
        background: var(--colorSubtleBackgroundHover);
      }
      .nav-link.active {
        color: var(--colorBrandForeground1);
      }
      .nav-link.active::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 8px;
        right: 8px;
        height: 3px;
        background: var(--colorBrandForeground1);
        border-radius: var(--borderRadiusSmall) var(--borderRadiusSmall) 0 0;
      }
      .nav-github {
        margin-left: auto;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      .nav-github i {
        font-size: 18px;
      }

      /* ── Page Card ── */
      .page-card {
        margin-top: 16px;
        padding: 20px;
        background: var(--colorNeutralBackground2);
        border: 1px solid var(--colorNeutralStroke2);
        border-radius: var(--borderRadiusXLarge);
        box-shadow: var(--shadow4);
      }
      .page-content {
        max-width: 100%;
      }

      /* ── Utilities ── */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
    </style>
  </body>
</html>
